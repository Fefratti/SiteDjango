{% extends 'blog/base.html' %}

{% block content %}
    <article>
        <h2>{{ post.title }}</h2>
        <p>Publicado em: {{ post.date|date:"d/m/Y H:i" }}</p>
        
        {% if post.categories.all %}
            <p><strong>Categorias:</strong>
                {% for category in post.categories.all %}
                    <a href="{% url 'category_detail' pk=category.pk %}">{{ category.name }}</a>
                    {% if not forloop.last %}, {% endif %}
                {% endfor %}
            </p>
        {% endif %}
        <hr>
        <div>{{ post.content|safe }}</div>
    </article>

    <hr>
    <a href="{% url 'post_update' pk=post.pk %}">Editar Post</a> | 
    <a href="{% url 'post_delete' pk=post.pk %}">Deletar Post</a>
    
    <hr>
    <h3>Comentários</h3>
    
    <a class="btn btn-default" href="{% url 'add_comment_to_post' pk=post.pk %}">Adicionar comentário</a>
    
    <br><br>

    {% for comment in post.comments.all|dictsortreversed:"date" %}
        <div style="border: 1px solid #ccc; padding: 10px; margin-bottom: 10px;">
            <strong>{{ comment.author }}</strong> disse:
            <p>{{ comment.text|linebreaks }}</p>
            <small>{{ comment.date|date:"d/m/Y H:i" }}</small>
        </div>
    {% empty %}
        <p>Nenhum comentário ainda.</p>
    {% endfor %}

{% endblock %}